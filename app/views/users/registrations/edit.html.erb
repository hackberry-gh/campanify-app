<article class="form">
	<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => {:method => :put}) do |f| %>
	
	<legend>Edit <%= resource_name.to_s.humanize %></legend>
	
  <%= devise_error_messages! %>

	<fieldset>
  <% resource.setting("fields").map(&:to_sym).each do |field| %>
  <div>
  <%= f.text_field field,
	:"data-label" => t("attributes.user.#{field}"), 
	:placeholder => t("attributes.user.#{field}") %></div>
	<% end %>	

	<% resource.setting("options").each do |field, checked| %>
  <div>
  <%= f.check_box field.to_sym, :checked => checked,
	:"data-label" => t("attributes.user.#{field}"), 
	:placeholder => t("attributes.user.#{field}") %></div>
	<% end %>
	
	<div>
	<%= f.label :avatar %>
  <%= f.file_field :avatar,
	:"data-label" => t("attributes.user.avatar"), 
	:placeholder => t("attributes.user.avatar") %>
	</div>
	<% if current_user.avatar? %>
	<div>
		<label></label>
		<%= image_tag(current_user.avatar_url) %>
		<br/>
		<label for="user_remove_avatar">Remove Avatar</label> <%= f.check_box :remove_avatar %>	
	</div>
	<% end %>
	</fieldset>
	
	<% if resource.setting("password_required") != "never" %>
	<fieldset>
  <div><i>(leave blank if you don't want to change it)</i>
  <%= f.password_field :password, :autocomplete => "off",
	:"data-label" => t("attributes.user.password"), 
	:placeholder => t("attributes.user.password") %> %></div>

  <div>
  <%= f.password_field :password_confirmation,
	:"data-label" => t("attributes.user.password_confirmation"), 
	:placeholder => t("attributes.user.password_confirmation") %></div>
	</fieldset>

  <div><i>(we need your current password to confirm your changes)</i>
  <%= f.password_field :current_password,
	:"data-label" => t("attributes.user.current_password"), 
	:placeholder => t("attributes.user.current_password") %></div>	

	<% end %>
		
  <div class="actions"><%= f.submit "Update" %></div>

	<fieldset>
		<h3>Cancel my account</h3>

		<p>Unhappy? <%= link_to "Cancel my account", registration_path(resource_name), :data => { :confirm => "Are you sure?" }, :method => :delete %>.</p>
	</fieldset>	

<% end %>
	<nav>
		<%= link_to "Back", :back %>
	</nav>
</article>